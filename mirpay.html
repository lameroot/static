

<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:type" content="article" />
        <meta property="article:tag" content="eCommerce" />
        <meta property="article:tag" content="API V1" />
    
    <meta property="og:locale" content="ru_RU">
    <meta property="og:site_name" content="Платежная документация">
    <meta property="og:title" content="Платежная документация ALFA">
    
    <meta property="og:description" content="Платежи Mir Pay">

    <link href="../../images/favicon-e2c1fda8.png" rel="icon" type="image/png" />
    <title>Документация</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nn {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nl {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ni {
  color: #ffffff;
  background-color: #272822;
}
.highlight .bp {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vg {
  color: #ffffff;
  background-color: #272822;
}
.highlight .vi {
  color: #ffffff;
  background-color: #272822;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
  background-color: #272822;
}
.highlight .w {
  color: #ffffff;
  background-color: #272822;
}
.highlight {
  color: #ffffff;
  background-color: #272822;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
  background-color: #272822;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="../../stylesheets/jsoneditor.min-71243ef2.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../assets/stylesheets/jquery.fancybox.min.css">
    <link href="../../stylesheets/screen-3451cd44.css" rel="stylesheet" media="screen" />
    <link href="../../stylesheets/print-bcbd23c6.css" rel="stylesheet" media="print" />
    <script src="../../javascripts/mermaid-9138cb77.js"></script>
    <script src="../../javascripts/all-5944b8d5.js"></script>
    <script src="../../javascripts/highlight.min-f104d103.js"></script>
    <script src="../../javascripts/jsoneditor.min-e220fc00.js"></script>
    <script src="../../javascripts/parsley.min-95276a45.js"></script>
    <script src="../../javascripts/jquery.fancybox-2fb64e91.js"></script>
    <script src="../../javascripts/algoliasearch-lite.umd-8f9c3ad3.js"></script>
    <script src="../../javascripts/instantsearch.production.min-b710d498.js"></script>
    <script src="../../javascripts/feedback-ac5a9096.js"></script>

    
    <style>
      .breadcrumbs {
        display: none !important;
      }
    </style>
    
    <script>
      window.homeLink = `${document.location.origin}/sandbox`;
      window.isDocker = "false"
      window.globalContext = "/sandbox";
      window.pgUAT = "https://alfa.rbsuat.com/payment";
      window.algoliaIndex = "prod_abby";
      window.bankName = "alfa"
      $(document).ready(function() {
        var languages = $('body').data('languages');
        $('.lang-selector').each(function(index, item) {
          if ($(item).is(':empty')) {
            languages.forEach(function(lang) {
              $(item).append("<a href='#' data-language-name=" + lang + ">" + lang + "</a>");
            });
          }
        });
        $('pre.highlight').show();
      });
      
      var translations = {
        'need-auth': 'Вам необходимо войти в Sandbox. После этого вы сможете использовать виджеты API.',
        'need-first-sandbox': 'Вам необходимо создать ваш первый Sandbox. После этого вы сможете использовать виджеты API.',
        'need-sandbox-creating': 'Ваш Sandbox сейчас в процессе создания. После завершения вы сможете использовать виджеты API.',
        headers: 'Заголовки запросов',
        params: 'Параметры запроса',
        unlogged: 'Войти',
        logged: 'Кабинет',
        'add-param': 'Добавить параметр',
        curl: 'Созданный cURL',
        send: 'Отправить',
        name: 'Имя',
        value: 'Значение',
        body: 'Тело запроса',
        error: 'Произошла непредвиденная ошибка. Пожалуйста, повторите попытку позже.',
        'enter-name': 'Введите имя...',
        'enter-value': 'Введите значение...'
      }
      var monthNames = [
          'Янв',
          'Фев',
          'Мар',
          'Апр',
          'Май',
          'Июн',
          'Июл',
          'Авг',
          'Сен',
          'Окт',
          'Ноя',
          'Дек',
      ]
      
    </script>
    

    
        <!-- Yandex.Metrika counter -->
          <script type="text/javascript" >
            (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
              var z = null;m[i].l=1*new Date();
              for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
              k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
              (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

              ym(91565627, "init", {
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          </script>
          <noscript><div><img src="https://mc.yandex.ru/watch/91565627" style="position:absolute; left:-9999px;" alt=""></div></noscript>
        <!-- /Yandex.Metrika counter -->
    
  </head>
  <body class="integration integration_api integration_api_mirpay" data-languages="[&quot;shell&quot;]">

     <div class="toc-wrapper" id="toc-wrapper">
    
        <a href="https://alfabank.ru/sme/payservice/internet-acquiring/docs/documentation/" data-need-to-replace-href="true" data-home-link="/sandbox" class="toc-wrapper__logo">
        <img src="../../images/logo-d8ae6b2d.svg" class="logo" alt="" />
      </a>
     
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#mir_pay" data-slug="mir_pay" class="toc-h1 toc-link" data-title="Mir Pay">
              <span>Mir Pay</span>
            </a>

              <ul class="toc-list-h2">
                  <li>
                    <a href="#mirpay-intro" class="toc-h2 toc-link" data-title="Введение">
                      Введение
                    </a>
                  </li>
                  <li>
                    <a href="#integration-schemes" class="toc-h2 toc-link" data-title="Схемы интеграции">
                      Схемы интеграции
                    </a>
                  </li>
                  <li>
                    <a href="#mirpay-api-request" class="toc-h2 toc-link" data-title="API-запросы Mir Pay">
                      API-запросы Mir Pay
                    </a>
                  </li>
              </ul>
          </li>
      </ul>


      
      <!-- Contact US -->
      <div class="contact-us">
        <div class="contact-us__inner">
          <p>По любому вопросу мы в одном клике</p>
          <a href="javascript:;" data-fancybox data-src="#contact-us-modal" class="btn">
            <div class="btn__text">Задать вопрос</div>
          </a>
        </div>
      </div>
      <!-- /Contact US -->
      
    </div>

    <div class="page-wrapper">
        
        <select style="display: none;" js-select-lang name="langs" id="">
                
                  
                    <option value="ru" selected>RU</option>
                  
                
                  
                    <option value="en">EN</option>
                  
                
        </select>
      

      <div class="mobile-header">
        <a href="/" class="mobile-header__logo">
          <img src="../../images/logo-d8ae6b2d.svg" alt="" />
        </a>

        <div class="mobile-icons">
        
          <div class="mobile-header__btn" id="mobile-nav-btn"></div>
        </div>
      </div>

      <div class="content">
        <nav aria-label="breadcrumbs" class="breadcrumbs">
    <ol>
      
        
          <li><a href="/#ecommerce">Главная</a></li>
        
      
        
          <li><a href="#" aria-current="location">Mir Pay</a></li>
        
      
    </ol>
</nav>
<h1 id="mir_pay">Mir Pay</h1>
<h2 id="mirpay-intro">Введение</h2>
<p>Платежная система <strong>Мир</strong> предоставляет возможность принимать платежи из приложений мерчанта или мобильных версий сайтов с использованием сервиса Mir Pay.</p>
<p>В следующих разделах описывается интеграция метода оплаты Mir Pay In-Application.</p>

<aside class="warning">
Вызов способа оплаты доступен только на мобильных устройствах Android, на которых установлено приложение Mir Pay.
</aside>
<p>Чтобы принимать платежи через Mir Pay, у вас должна быть включена эта функция.</p>
<h2 id="integration-schemes">Схемы интеграции</h2>
<h3 id="payment-page">Платежная страница на стороне Платежного шлюза</h3>

<div class="mermaid">
 sequenceDiagram
 participant C as Клиент
 participant M as Мерчант
 participant P as Платежная страница
 participant G as Платежный шлюз
 participant MP as Mir Pay
 C-&gt;&gt;M: 1. Формирование заказа
 M-&gt;&gt;G: 2. Запрос на регистрацию заказа
 G--&gt;&gt;M: 3. Ответ на запрос
 M--&gt;&gt;C: 4. Перенаправление на платежную страницу
 C-&gt;&gt;P: 5. Получение платежной формы
 P-&gt;&gt;G: 6. Запрос возможных способов оплаты
 G-&gt;&gt;G: 7. Формирование Universal link
 G--&gt;&gt;P: 8. Опция продавца Mir Pay, Universal link
 P--&gt;&gt;C: 9. Платежная форма
 C-&gt;&gt;P: 10. Выбор способа оплаты Mir Pay
 P-&gt;&gt;MP: 11. Universal link
 MP-&gt;&gt;MP: 12. Проверка
 MP--&gt;&gt;C: 13. Список карт
 C-&gt;&gt;MP: 14. Выбор карты
 MP--&gt;&gt;C: 15. Перенаправление клиента на платежную страницу
 MP--&gt;&gt;G: 16. Платежные данные
 G-&gt;&gt;G: 17. Расшифровка данных
 G-&gt;&gt;G: 18. Оплата токеном
 C-&gt;&gt;P: 19. Запрос результата платежа
 P-&gt;&gt;G: 20. Запрос результата платежа
 G--&gt;&gt;P: 21. Результат оплаты
 P--&gt;&gt;C: 22. Результат оплаты
</div>

<ol>
<li>Клиент формирует заказ на сайте мерчанта.</li>
<li>Продавец направляет в платежный шлюз запрос регистрации заказа.<br>a. При одностадийном платеже - <a href="rest.html#register">register.do</a>;<br>b. При двухстадийном платеже - <a href="rest.html#registerpreauth">registerPreAuth.do</a>
</li>
<li>Платежный шлюз регистрирует заказ и отправляет мерчанту ответ, содержащий параметр <code>formUrl</code> (платежный URL-адрес, на который мерчант должен перенаправить клиента) и параметр  <code>orderId</code>  (уникальный номер заказа в системе платежного шлюза).</li>
<li>Интернет-магазин перенаправляет клиента на URL, полученный в параметре  <code>formUrl</code>.</li>
<li>Браузер клиента открывает полученный URL.</li>
<li>Платежная страница запрашивает список возможных способов оплаты у платежного шлюза.</li>
<li>Платежный шлюз формирует Universal link.</li>
<li>Платежный шлюз в ответе возвращает опцию мерчанта Mir Pay и Universal link.</li>
<li>Клиент получает платежную форму с отрисованной кнопкой оплаты MirPay.</li>
<li>Клиент выбирает способ оплаты Mir Pay на платежной странице.</li>
<li>Платежная страница запускает Universal link на устройстве клиента.</li>
<li>Mir Pay проверяет подпись продавца и его участие в программе.</li>
<li>Mir Pay отображает список карт клиенту.</li>
<li>Клиент выбирает карту для оплаты в приложении Mir Pay.</li>
<li>Mir Pay передает браузеру клиента redirect на URL платежной страницы.</li>
<li>Mir Pay формирует данные платежа и отправляет зашифрованные данные платежа в платежный шлюз.</li>
<li>Платежный шлюз расшифровывает данные платежа.</li>
<li>Платежный шлюз осуществляет оплату.</li>
<li>Браузер клиента обращается к платежной странице для получения результата оплаты.</li>
<li>Платежная страница запрашивает у платежного шлюза результат оплаты.</li>
<li>Платежный шлюз возвращает результат оплаты на платежную страницу.</li>
<li>Платежная страница отображает результат оплаты клиенту.</li>
</ol>
<h3 id="payment-page-merchant-side">Платежная страница/приложение на стороне мерчанта</h3>
<h4 id="neobhodimye-uslowija">Необходимые условия</h4>
<p>Для того, чтобы иметь возможность принимать платежи Mir Pay через платежный шлюз, у вас должен быть выпущенный для вас сертификат. Для получения данного сертификата обратитесь в службу технической поддержки.</p>
<p>Вместе с конечным сертификатом вы должны получить от службы технической поддержки следующее:</p>

<ol>
<li>Документ «Стандарт платежной системы «Мир». Описание реализации Mir Pay Android In-Application операций для ТСП».</li>
<li>Библиотека MirPaySDK.aar для встраивания в мобильное приложение продавца.</li>
<li>Описание API  в виде yaml-файла;</li>
<li>URL-адрес файла конечного сертификата ТСП на общедоступном Web-ресурсе Агрегатора (https://&lt;хост участника&gt;/jwks/-jwks.json), если данное ТСП поддерживает технологию In-Application Web-based операций.</li>
</ol>

<div class="mermaid">
 sequenceDiagram
 participant C as Клиент
 participant M as Мерчант
 participant G as Платежный шлюз
 participant MP as Mir Pay
 C-&gt;&gt;M: 1. Выбор способа оплаты Mir Pay
 M-&gt;&gt;MP: 2. Вызов Mir Pay
 MP-&gt;&gt;MP: 3. Проверка подписи
 MP--&gt;&gt;C: 4. Список карт
 C-&gt;&gt;MP: 5. Выбор карты
 MP--&gt;&gt;M: 6. Зашифрованные платежные данные
 M-&gt;&gt;G: 7. Запрос на оплату Mir Pay
 G-&gt;&gt;G: 8. Расшифровка данных
 G-&gt;&gt;G: 9. Оплата
 G--&gt;&gt;M: 10. Результат оплаты
 M--&gt;&gt;C: 11. Результат оплаты
</div>

<ol>
<li>Клиент выбирает способ оплаты Mir Pay на платежной странице мерчанта.</li>
<li>Продавец запускает скрипт подготовки операции In-Application через MirPaySDK в приложении Mir Pay / Продавец запускает скрипт подготовки операции In-Application через Deeplink или Universal Link в приложении Mir Pay.</li>
<li>Mir Pay проверяет подпись продавца и его участие в программе.</li>
<li>Mir Pay отображает список карт клиенту.</li>
<li>Клиент выбирает карту для оплаты в приложении Mir Pay.</li>
<li>Mir Pay формирует данные платежа и отправляет зашифрованные данные платежа продавцу.</li>
<li>Продавец запрашивает платеж, отправляя API-запрос <a href="#mirpay_payment">/mir/payment.do</a> в платежный шлюз.</li>
<li>Платежный шлюз расшифровывает данные платежа.</li>
<li>Платежный шлюз осуществляет оплату.</li>
<li>Платежный шлюз возвращает результат оплаты мерчанту.</li>
<li>Мерчант отображает результат оплаты клиенту.</li>
</ol>
<h3 id="payment-data-merchant-side">Расшифровка платежных данных на стороне продавца</h3>

<aside class="notice">
Чтобы принимать платежи, когда платежные данные расшифрованы на вашей стороне, у вас должно быть включено разрешение «Может платить с помощью расшифрованных токенов». Кроме того, для реализации этого сценария вам необходимо получить сертификат Агрегатора (обратитесь в команду поддержки НСПК).
</aside>

<div class="mermaid">
 sequenceDiagram
 participant C as Клиент
 participant M as Мерчант
 participant G as Платежный шлюз
 participant MP as Mir Pay
 C-&gt;&gt;M: 1. Выбор способа оплаты Mir Pay
 M-&gt;&gt;MP: 2. Вызов Mir Pay
 MP-&gt;&gt;MP: 3. Проверка подписи
 MP--&gt;&gt;C: 4. Список карт
 C-&gt;&gt;MP: 5. Выбор карты
 MP--&gt;&gt;M: 6. Зашифрованные платежные данные
 M-&gt;&gt;M: 7. Расшифровка данных
 M-&gt;&gt;G: 8. Запрос на оплату Mir Pay
 G-&gt;&gt;G: 9. Оплата
 G--&gt;&gt;M: 10. Результат оплаты
 M--&gt;&gt;C: 11. Результат оплаты
</div>

<ol>
<li>Клиент выбирает способ оплаты Mir Pay на платежной странице.</li>
<li>Продавец запускает скрипт подготовки операции In-Application через MirPaySDK в приложении Mir Pay / Продавец запускает скрипт подготовки операции In-Application через Deeplink или Universal Link в приложении Mir Pay.</li>
<li>Mir Pay проверяет подпись продавца и его участие в программе.</li>
<li>Mir Pay отображает список карт клиенту.</li>
<li>Клиент выбирает карту для оплаты в приложении Mir Pay.</li>
<li>Mir Pay формирует данные платежа и отправляет зашифрованные данные платежа в мерчанту.</li>
<li>Продавец расшифровывает данные платежа.</li>
<li>Продавец создает запрос на проведение платежа <a href="#mirpay_paymentdirect">/mir/paymentDirect.do</a>, содержащий расшифрованные платежные данные, и отправляет его платежному шлюзу.</li>
<li>Платежный шлюз осуществляет оплату.</li>
<li>Платежный шлюз возвращает результат оплаты мерчанту.</li>
<li>Мерчант отображает результат оплаты клиенту.</li>
</ol>
<h2 id="mirpay-api-request">API-запросы Mir Pay</h2>

<h3 id="mirpay_payment">Регистрация заказа Mir Pay Pay</h3>

<p>Для регистрации и оплаты заказа используется запрос <code>https://alfa.rbsuat.com/payment/mir/payment.do</code>. Запрос доступен, если мерчант имеет соответствующее разрешение.</p>

<p><br>При выполнении запроса необходимо использовать заголовок: 
<code>Content-Type: application/json</code></p>

<h4 id="mirpay_payment_request_parameters">Параметры запроса</h4>

<table id="table-3958">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Условие <p></p>
</td>
<td><code>merchant</code></td>
<td>String [1..255]</td>
<td>Логин продавца в системе платежного шлюза. Обязательно, если авторизация осуществляется через <code>merchant</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие <p></p>
</td>
<td><code>username</code></td>
<td>String [1..30]</td>
<td>Логин учетной записи API продавца. Обязательно, если авторизация осуществляется через <code>username</code> и <code>password</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие <p></p>
</td>
<td><code>password</code></td>
<td>String [1..30]</td>
<td>Пароль учетной записи API продавца. Обязательно, если авторизация осуществляется через <code>username</code> и <code>password</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>orderNumber</code></td>
<td>String [1..36]</td>
<td>Номер заказа (ID) в системе мерчанта; должен быть уникальным для каждого заказа.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>description</code></td>
<td>String [1..598]</td>
<td>Описание заказа в любом формате. <br>Чтобы включить отправку этого поля в процессинговую систему, обратитесь в службу технической поддержки.<br> В этом поле недопустимо передавать персональные данные или платежные данные (номера карт т.п.). Данное требование связано с тем, что описание заказа нигде не маскируется.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>language</code></td>
<td>String [2]</td>
<td>Ключ языка по ISO 639-1. Если язык не указан, используется язык по умолчанию, указанный в настройках магазина.<br>Поддерживаемые языки: ru,en,de,fr,es,it,zh,ja,ko,ua,kz.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>additionalParameters</code></td>
<td>Object</td>
<td>Дополнительные параметры заказа, которые хранятся в личном кабинете продавца для последующего просмотра. Каждая новая пара имени параметра и его значения должна быть разделена запятой. Ниже приведен пример использования.<br><code>{ "firstParamName": "firstParamValue", "secondParamName": "secondParamValue"}</code>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>preAuth</code></td>
<td>Boolean</td>
<td>Параметр, определяющий необходимость предварительной авторизации (блокирования средств на счете клиента до их списания). Доступны следующие значения:<br><ul>
<li>
<code>true</code> - включена двухстадийная оплата;</li>
<li>
<code>false</code> - включена одностадийная оплата (деньги списываются сразу).</li>
</ul>
<b>Если параметр отсутствует, производится одностадийная оплата.</b>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>ip</code></td>
<td>String [1..39]</td>
<td>IP адрес плательщика. IPv6 поддерживается во всех запросах (до 39 символов).<br> <aside class="notice"> При использовании аутентификации 3DS 2 рекомендуем вам передавать в этом параметре реальный IP адрес клиента. Это позволит повысить конверсию в оплату на стороне ACS. </aside>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно  <p></p>
</td>
<td><code>clientId</code></td>
<td>String [0..255]</td>
<td>Номер клиента (ID) в системе мерчанта — до 255 символов. Используется для реализации функциональности связок. Может возвращаться в ответе, если мерчанту разрешено создавать связки.<br>Указание этого параметра при обработке платежей по связке обязательно. В противном случае платеж будет невозможен.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>paymentToken</code></td>
<td>String [1..8192]</td>
<td>Строка в формате JWE Compact Serialization с данными операции In-Application.</td>
</tr>
</tbody>
</table>

<h4 id="mirpay_payment_response_parameters">Параметры ответа</h4>

<table id="table-1055">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p id="p-501"></p>
</td>
<td><code>success</code></td>
<td>Boolean</td>
<td>Основной параметр, который указывает на то, что запрос прошел успешно. Доступны следующие значения:<br><ul>
<li>
<tt>true</tt> - запрос успешно обработан;</li>
<li>
<tt>false</tt> - запрос не прошел.</li>
</ul>
<br>Обратите внимание, что значение <code>true</code> означает, что запрос был обработан, а не что заказ был оплачен.<br> Более подробная информация о том, как узнать, был ли платеж успешным или нет, доступна <a href="rest.html#payment-status">здесь</a>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие</td>
<td><a href="#data%20Mir%20Pay%20registration%20rest"><code>data</code></a></td>
<td>Object</td>
<td>Этот параметр возвращается только в случае успешной обработки платежа. См. описание ниже.</td>
</tr>
<tr>
<td>Условие</td>
<td><a href="#error%20Mir%20Pay%20registration%20rest"><code>error</code></a></td>
<td>Object</td>
<td>Этот параметр возвращается только в случае ошибки платежа. См. описание ниже.</td>
</tr>
</tbody>
</table>

<p><a id="data Mir Pay registration rest" href="#data%20Mir%20Pay%20registration%20rest"></a>
Блок <code>data</code> содержит следующие элементы.</p>

<table id="table-169">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>orderId</code></td>
<td>String [1..36]</td>
<td>Номер заказа в платежном шлюзе. Уникален в пределах платежного шлюза.</td>
</tr>
</tbody>
</table>

<p><a id="error Mir Pay registration rest" href="#error%20Mir%20Pay%20registration%20rest"></a>
Блок <code>error</code> содержит следующие элементы.</p>

<table id="table-752">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>code</code></td>
<td>String [1..3]</td>
<td>Код как информационный параметр, сообщающий об ошибке.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>description</code></td>
<td>String [1..598]</td>
<td>Подробное техническое объяснение ошибки - содержимое этого параметра не предназначено для отображения пользователю.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>message</code></td>
<td>String [1..512]</td>
<td>Информационный параметр, являющийся описанием ошибки для отображения пользователю. Параметр может варьироваться, поэтому не следует явным образом ссылаться на его значения в коде.</td>
</tr>
</tbody>
</table>

<h4 id="mirpay_payment_examples">Примеры</h4>

<h4 id="mirpay_payment_request_example">Пример запроса</h4>

<div class="highlight"><pre class="highlight shell tab-shell"><code class="hljs language-curl">curl --request POST \
--url https://alfa.rbsuat.com/payment/mir/payment.do \
--header 'Content-Type: application/json' \
--data-raw '{
    "username": "test_user",
    "password": "test_user_password",
    "orderNumber": "243ec139-4b5a-7859-b409-bbcb4806bc81",
    "description": "Order description",
    "language": "en",
    "additionalParameters": {},
    "preAuth" : false,
    "ip": "x.x.x.x",
    "paymentToken": "eyJhbGciOiJSU0...9HDxLg"
}'</code></pre></div><h4 id="mirpay_payment_response_example_success">Ответ в случае успешной оплаты</h4>
<div class="highlight"><pre class="highlight json tab-json"><code class="hljs language-json">{
    "success": true,
    "data": {
        "orderId": "243ec139-4b5a-7859-b409-bbcb4806bc81"
    }
}</code></pre></div><h4 id="mirpay_payment_response_example_fail">Ответ в случае неудачной оплаты</h4>
<div class="highlight"><pre class="highlight json tab-json"><code class="hljs language-json">{
  "error": {
    "code": 1,
    "description": "Processing Error",
    "message": "Insufficient amount on card"
  },
  "success": false
}</code></pre></div>

<h3 id="mirpay_paymentdirect">Mir Pay Direct</h3>

<p>Запрос, используемый для осуществления прямого платежа через Mir Pay - <code>https://alfa.rbsuat.com/payment/mir/paymentDirect.do</code>. Запрос доступен, если мерчант имеет соответствующее разрешение.</p>

<p>Этот запрос можно использовать для интеграций, предполагающих расшифровку платежных данных на стороне продавца.</p>

<p><br>При выполнении запроса необходимо использовать заголовок: 
<code>Content-Type: application/json</code></p>

<aside class="notice">
    Если значение параметра <tt>tii</tt> = <tt>R</tt>,<tt>U</tt> или <tt>F</tt>, то в запросе должны быть переданы параметры <tt>originalPaymentNetRefNum</tt> и <tt>originalPaymentDate</tt>. Если данные параметры не были переданы в запросе, это означает, что будет происходить простая оплата.
</aside>

<h4 id="mirpay_paymentdirect_request_parameters">Параметры запроса</h4>

<table id="table-3498">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Условие <p></p>
</td>
<td><code>merchant</code></td>
<td>String [1..255]</td>
<td>Логин продавца в системе платежного шлюза. Обязательно, если авторизация осуществляется через <code>merchant</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие <p></p>
</td>
<td><code>username</code></td>
<td>String [1..30]</td>
<td>Логин учетной записи API продавца. Обязательно, если авторизация осуществляется через <code>username</code> и <code>password</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие <p></p>
</td>
<td><code>password</code></td>
<td>String [1..30]</td>
<td>Пароль учетной записи API продавца. Обязательно, если авторизация осуществляется через <code>username</code> и <code>password</code>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>orderNumber</code></td>
<td>String [1..36]</td>
<td>Номер заказа (ID) в системе мерчанта; должен быть уникальным для каждого заказа.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>description</code></td>
<td>String [1..598]</td>
<td>Описание заказа в любом формате. <br>Чтобы включить отправку этого поля в процессинговую систему, обратитесь в службу технической поддержки.<br> В этом поле недопустимо передавать персональные данные или платежные данные (номера карт т.п.). Данное требование связано с тем, что описание заказа нигде не маскируется.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>language</code></td>
<td>String [2]</td>
<td>Ключ языка по ISO 639-1. Если язык не указан, используется язык по умолчанию, указанный в настройках магазина.<br>Поддерживаемые языки: ru,en,de,fr,es,it,zh,ja,ko,ua,kz.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>additionalParameters</code></td>
<td>Object</td>
<td>Дополнительные параметры заказа, которые хранятся в личном кабинете продавца для последующего просмотра. Каждая новая пара имени параметра и его значения должна быть разделена запятой. Ниже приведен пример использования.<br><code>{ "firstParamName": "firstParamValue", "secondParamName": "secondParamValue"}</code>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Необязательно <p></p>
</td>
<td><code>preAuth</code></td>
<td>Boolean</td>
<td>Параметр, определяющий необходимость предварительной авторизации (блокирования средств на счете клиента до их списания). Доступны следующие значения:<br><ul>
<li>
<code>true</code> - включена двухстадийная оплата;</li>
<li>
<code>false</code> - включена одностадийная оплата (деньги списываются сразу).</li>
</ul>
<b>Если параметр отсутствует, производится одностадийная оплата.</b>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>ip</code></td>
<td>String [1..39]</td>
<td>IP адрес плательщика. IPv6 поддерживается во всех запросах (до 39 символов).<br> <aside class="notice"> При использовании аутентификации 3DS 2 рекомендуем вам передавать в этом параметре реальный IP адрес клиента. Это позволит повысить конверсию в оплату на стороне ACS. </aside>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>paymentToken</code></td>
<td>String [1..8192]</td>
<td>Токен, полученный от MirPay. Значение должно быть закодировано в Base64.</td>
</tr>
</tbody>
</table>

<h4 id="mirpay_paymentdirect_response_parameters">Параметры ответа</h4>

<table id="table-1043">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p id="p-501"></p>
</td>
<td><code>success</code></td>
<td>Boolean</td>
<td>Основной параметр, который указывает на то, что запрос прошел успешно. Доступны следующие значения:<br><ul>
<li>
<tt>true</tt> - запрос успешно обработан;</li>
<li>
<tt>false</tt> - запрос не прошел.</li>
</ul>
<br>Обратите внимание, что значение <code>true</code> означает, что запрос был обработан, а не что заказ был оплачен.<br> Более подробная информация о том, как узнать, был ли платеж успешным или нет, доступна <a href="rest.html#payment-status">здесь</a>.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Условие</td>
<td><a href="#data%20Mir%20Pay%20Direct%20rest"><code>data</code></a></td>
<td>Object</td>
<td>Этот параметр возвращается только в случае успешной обработки платежа. См. описание ниже.</td>
</tr>
<tr>
<td>Условие</td>
<td><a href="#error%20Mir%20Pay%20Direct%20rest"><code>error</code></a></td>
<td>Object</td>
<td>Этот параметр возвращается только в случае ошибки платежа. См. описание ниже.</td>
</tr>
</tbody>
</table>

<p><a id="data Mir Pay Direct rest" href="#data%20Mir%20Pay%20Direct%20rest"></a>
Блок <code>data</code> содержит следующие элементы.</p>

<table id="table-169">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>orderId</code></td>
<td>String [1..36]</td>
<td>Номер заказа в платежном шлюзе. Уникален в пределах платежного шлюза.</td>
</tr>
</tbody>
</table>

<p><a id="error Mir Pay Direct rest" href="#error%20Mir%20Pay%20Direct%20rest"></a>
Блок <code>error</code> содержит следующие элементы.</p>

<table id="table-752">
<thead>
<tr>
<th>Обязательность</th>
<th>Название</th>
<th>Тип</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>code</code></td>
<td>String [1..3]</td>
<td>Код как информационный параметр, сообщающий об ошибке.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>description</code></td>
<td>String [1..598]</td>
<td>Подробное техническое объяснение ошибки - содержимое этого параметра не предназначено для отображения пользователю.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Обязательно <p></p>
</td>
<td><code>message</code></td>
<td>String [1..512]</td>
<td>Информационный параметр, являющийся описанием ошибки для отображения пользователю. Параметр может варьироваться, поэтому не следует явным образом ссылаться на его значения в коде.</td>
</tr>
</tbody>
</table>

<h4 id="mirpay_paymentdirect_examples">Примеры</h4>

<h4 id="mirpay_paymentdirect_request_example">Пример запроса</h4>

<div class="highlight"><pre class="highlight shell tab-shell"><code class="hljs language-curl">curl --request POST \
--url https://alfa.rbsuat.com/payment/mir/paymentDirect.do \
--header 'Content-Type: application/json' \
--data-raw '{
    "username": "test_user",
    "password": "test_user_password",
    "orderNumber": "243ec139-4b5a-7859-b409-bbcb4806bc81",
    "description": "Order description",
    "language": "en",
    "additionalParameters": {},
    "preAuth" : false,
    "ip": "x.x.x.x",
    "paymentToken": "eyJ0YW4iOiIyMj...wifQ=="
}'</code></pre></div><h4 id="mirpay_paymentdirect_response_example_success">Ответ в случае успешной оплаты</h4>
<div class="highlight"><pre class="highlight json tab-json"><code class="hljs language-json">{
    "success": true,
    "data": {
        "orderId": "243ec139-4b5a-7859-b409-bbcb4806bc81"
    }
}</code></pre></div><h4 id="mirpay_paymentdirect_response_example_fail">Ответ в случае неудачной оплаты</h4>
<div class="highlight"><pre class="highlight json tab-json"><code class="hljs language-json">{
  "error": {
    "code": 1,
    "description": "Processing Error",
    "message": "Insufficient amount on card"
  },
  "success": false
}</code></pre></div>
<p>    <aside class="notice">
        Подробнее об API запросах смотрите <a href="../../integration/api/rest.html">по ссылке</a>.
    </aside></p>

        
      </div>

      
            <div class="categories__wrapper">
              <div class="categories__wrapper-title">Категории:</div>
              <div class="categories__wrapper-list">
                  <span class="categories__wrapper-list__item">eCommerce</span>
                  <span class="categories__wrapper-list__item">API V1</span>
              </div>
            </div>
      

        
        <div class="toc-wrapper__right" id="toc-wrapper-right">
        <ul id="toc-right" class="toc-list-h3">
        <div class="toc-list-h3 title" style="display: none;">В этом пункте</div>
                    <li style="display: none;">
                      <a href="#payment-page" class="toc-h3 toc-link" data-title="Платежная страница на стороне Платежного шлюза" data-parent="integration-schemes">
                        Платежная страница на стороне Платежного шлюза
                      </a>
                    </li>
                    <li style="display: none;">
                      <a href="#payment-page-merchant-side" class="toc-h3 toc-link" data-title="Платежная страница/приложение на стороне мерчанта" data-parent="integration-schemes">
                        Платежная страница/приложение на стороне мерчанта
                      </a>
                    </li>
                    <li style="display: none;">
                      <a href="#payment-data-merchant-side" class="toc-h3 toc-link" data-title="Расшифровка платежных данных на стороне продавца" data-parent="integration-schemes">
                        Расшифровка платежных данных на стороне продавца
                      </a>
                    </li>
                    <li style="display: none;">
                      <a href="#mirpay_payment" class="toc-h3 toc-link" data-title="Регистрация заказа Mir Pay Pay" data-parent="mirpay-api-request">
                        Регистрация заказа Mir Pay Pay
                      </a>
                    </li>
                    <li style="display: none;">
                      <a href="#mirpay_paymentdirect" class="toc-h3 toc-link" data-title="Mir Pay Direct" data-parent="mirpay-api-request">
                        Mir Pay Direct
                      </a>
                    </li>
        </ul>
      </div>
    </div>

    
      

    
    </div>

    <!------------- MODALS ------------->
    
    <!---  Feedabck Modal -->
    <div style="display: none;" id="contact-us-modal" class="modal">
      <h2 class="modal__title">Свяжитесь с нами</h2>
      <p class="modal__subtitle">
            Напишите нам, если у вас есть какие-либо вопросы. Мы готовы помочь вам
        </p>
        <p class="contact-us-modal__error jsErr" style="display: none;">
            Ошибка. Попробуйте еще раз.
        </p>

        <form action="" class="modal__form" id="contact-us-form">
            <div class="form-control">
                <div class="form-control__label">Тема</div>
                <input class="form-control__input" name="title" required type="text" placeholder="Ваша тема">
            </div>

            <div class="form-control js-contact-us-form-email">
                <div class="form-control__label">Email</div>
                <input name="email" type="email" class="form-control__input" placeholder="address@email.com" required>
            </div>
            <div class="form-control">
                <div class="form-control__label">Ваш вопрос</div>
                <textarea name="body" class="form-control__input" placeholder="" required></textarea>
            </div>
            <div class="form-control">
              <div class="form-control__box" id="files"></div>
              <div class="dropzone" id="dropzone">
                <p>Добавьте файл или перетащите файлы сюда</p>
                <p id="filesExtensions">и другие</p>
                <input
                  id="fileInput"
                  data-parsley-errors-container="#files"
                  name="files"
                  type="file"
                  class="form-control__input"
                  placeholder=""
                  multiple
                  style="display: none"
                />
              </div>
              <ul id="fileList"></ul>
            </div>
            <button class="btn">Отправить</button>
        </form>
    </div>

    <!-- TY Feedback -->
    <div style="display: none;" class="modal feedback-success-modal" id="feedback-success-modal">
        <div class="success-icon">
          <!-- <img src="../../images/success_icon-7e2e6380.svg" alt="" /> -->
          <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2.18188" y="2.18188" width="43.6364" height="43.6364" rx="4" fill="currentColor"/>
            <mask id="mask0_3029_16472" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="44" height="44">
              <rect x="2.18188" y="2.18188" width="43.6364" height="43.6364" rx="4" fill="currentColor"/>
            </mask>
            <g mask="url(#mask0_3029_16472)">
              <path d="M47.0355 3.05834L47.9119 1.84104L45.4773 0.0881262L44.6009 1.30543L47.0355 3.05834ZM23.8254 32.7273L22.9746 33.9627C23.6468 34.4257 24.5658 34.2662 25.0427 33.6038L23.8254 32.7273ZM16.1236 25.6011C15.4413 25.1312 14.5073 25.3033 14.0374 25.9856C13.5675 26.6678 13.7396 27.6018 14.4218 28.0718L16.1236 25.6011ZM44.6009 1.30543L22.6081 31.8509L25.0427 33.6038L47.0355 3.05834L44.6009 1.30543ZM14.4218 28.0718L22.9746 33.9627L24.6763 31.492L16.1236 25.6011L14.4218 28.0718Z" fill="white"/>
            </g>
          </svg>
        </div>
        <h2 class="modal__title">Спасибо!</h2>
        <p class="modal__subtitle">
            Мы свяжемся с вами и ответим на вопрос
        </p>
        <button class="btn" type="button" onclick="closeModal()">
            <span class="btn__text">Закрыть</span>
        </button>
    </div>
    

    
    <script type="speculationrules">
      {
        "prerender": [{
          "source": "document",
          "where": {
            "href_matches": "/*"
          },
          "eagerness": "moderate"
        }]
      }
    </script>
    <script>
      mermaid.initialize({startOnLoad:true});
    </script>
  </body>
</html>